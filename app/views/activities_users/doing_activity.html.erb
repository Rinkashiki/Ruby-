<%= stylesheet_link_tag 'users' %>
<div class="container">
  <br>
  <div class="center handheld_display">
    <% flash.each do |type, msg| %>
      <div class="alert alert-success alert-dismissible d-inline-block" role="alert">
        <%= msg %>
      </div> 
    <% end %>
    <% flash.delete(:alert) %>
    <h1>Pregunta</h1>
    <h2 class="text-white" id="timer">
    </h2>
    <% if @type == 'Trivia' %>
      <%= render 'doing_trivia' %>
    <% end %>
    <% if @type == 'Video Trivia' %>
      <%= render 'doing_video_trivia' %>
    <% end %>
    <% if @type == 'Video Test' %>
      <%= render 'doing_video_test' %>
    <% end %>
    <% if @type == 'Pregunta Abierta' %>
      <%= render 'doing_open_question' %>
    <% end %>
  </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    var countdown = <%= @question.response_time.to_i %>
    var x = setInterval(function() {
      --countdown
      if (countdown % 60 < 10){
        $('#timer').html("0" + Math.floor(countdown / 60) + ":" + "0" + countdown % 60);
      }    
      else{
        $('#timer').html("0" + Math.floor(countdown / 60) + ":" + countdown % 60);
      }

      if(countdown <= 0){
        if (<%= @n_question %> < <%= @total_questions - 1 %>){
          window.location.href="/activities_users/doing_activity?activity=<%= @activity.id %>&n_question=<%= @n_question + 1 %>"
        } else{
          window.location.href="/activities_users"
        }
      }
    }, 1000);
  });
</script>